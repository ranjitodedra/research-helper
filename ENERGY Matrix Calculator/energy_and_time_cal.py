import math
import numpy as np

# Constants
M1 = 1530  # Mass with load (kg)
M2 = 5     # Mass without load (kg)
m = 100    # Additional mass (kg)
f = 0.01   # Friction coefficient
base_speed = 50  # Base speed (km/h)
A = 2.5    # Frontal area (m²)
g = 9.8    # Gravity (m/s²)
alpha_deg = 0.86  # Road angle (degrees)
p = 1.205  # Air density (kg/m³)
c = 0.3    # Drag coefficient (assumed value)

# Input matrices
D = [
 [0.0, 4.86, 5.11, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 [4.86, 0.0, 4.79, 6.59, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.55, 0.0, 0.0, 0.0, 0.0, 0.0],
 [5.11, 4.79, 0.0, 6.13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.68, 0.0, 0.0],
 [0.0, 6.59, 6.13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.51, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.82, 3.76, 4.88, 3.42, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.61, 0.0, 0.0, 0.0, 4.7, 4.96, 4.61, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.07, 0.0, 0.0, 0.0, 0.0, 5.72, 6.13, 0.0, 7.87, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.07, 0.0, 6.03, 0.0, 0.0, 0.0, 4.79, 0.0, 0.0, 0.0, 5.47],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.03, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.23, 6.13],
 [0.0, 0.0, 0.0, 0.0, 0.0, 4.61, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 4.82, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.7, 5.88, 0.0, 0.0, 0.0, 0.0],
 [0.0, 5.55, 0.0, 0.0, 3.76, 0.0, 0.0, 0.0, 0.0, 0.0, 6.7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 4.88, 0.0, 5.72, 4.79, 0.0, 0.0, 5.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 7.51, 3.42, 4.7, 6.13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.47, 0.0, 0.0],
 [0.0, 0.0, 5.68, 0.0, 0.0, 4.96, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.47, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 4.61, 7.87, 0.0, 6.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.47, 6.13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
]

TF = [
 [0.0, 0.78, 0.82, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 [0.78, 0.0, 0.99, 0.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.81, 0.0, 0.0, 0.0, 0.0, 0.0],
 [0.82, 0.99, 0.0, 0.98, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.96, 0.0, 0.0],
 [0.0, 0.9, 0.98, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.96, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.63, 0.97, 0.97, 0.95, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.71, 0.0, 0.0, 0.0, 0.91, 0.68, 0.72, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.86, 0.0, 0.0, 0.0, 0.0, 0.91, 0.96, 0.0, 0.95, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.86, 0.0, 0.68, 0.0, 0.0, 0.0, 0.64, 0.0, 0.0, 0.0, 0.76],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.68, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.86, 0.88],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.63, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99, 0.93, 0.0, 0.0, 0.0, 0.0],
 [0.0, 0.81, 0.0, 0.0, 0.97, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.97, 0.0, 0.91, 0.64, 0.0, 0.0, 0.93, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.96, 0.95, 0.91, 0.96, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.71, 0.0, 0.0],
 [0.0, 0.0, 0.96, 0.0, 0.0, 0.68, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.71, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.72, 0.95, 0.0, 0.86, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.76, 0.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
]

# Pre-calculate trigonometric values
cos_alpha = math.cos(math.radians(alpha_deg))
sin_alpha = math.sin(math.radians(alpha_deg))

# Initialize output matrices
n = len(D)
T = [[0.0 for _ in range(n)] for _ in range(n)]
Edrop = [[0.0 for _ in range(n)] for _ in range(n)]
Ebox = [[0.0 for _ in range(n)] for _ in range(n)]

# Calculate matrices
for i in range(n):
    for j in range(n):
        if D[i][j] != 0.0:  # Only calculate for existing edges
            d = D[i][j]  # Distance in km
            traffic_factor = TF[i][j]
            v0 = base_speed * traffic_factor  # Actual speed (km/h)
            
            # Travel time (hours)
            T[i][j] = round(d / v0, 2)
            
            # Determine dv_dt based on speed
            if 50 <= v0 <= 80:
                dv_dt = 0.3
            elif 81 <= v0 <= 120:
                dv_dt = 2
            else:
                dv_dt = 0
            
            # Calculate Edrop (energy with load)
            Edrop[i][j] = round((1 / 3600) * (
                M1 * g * (f * cos_alpha + sin_alpha) + 
                0.0386 * (p * c * A * v0**2) + 
                (M1 + m) * dv_dt
            ) * d, 2)
            
            # Calculate Ebox (energy without load)
            Ebox[i][j] = round((1 / 3600) * (
                M2 * g * (f * cos_alpha + sin_alpha) + 
                0.0386 * (p * c * A * v0**2) + 
                (M2 + m) * dv_dt
            ) * d, 2)

# Print results
def print_matrix(matrix, name):
    print(f"\n{name} = [")
    for row in matrix:
        formatted_row = [f"{val:.2f}" if val != 0 else "0.0" for val in row]
        print(f" [{', '.join(formatted_row)}],")
    print("]")

print("=" * 80)
print("RESULTS")
print("=" * 80)

print_matrix(T, "T (Travel Time in hours)")
print_matrix(Edrop, "Edrop (Energy with load)")
print_matrix(Ebox, "Ebox (Energy without load)")

# Also print in Python list format for easy copying
print("\n" + "=" * 80)
print("COPY-PASTE FORMAT")
print("=" * 80)

print("\nT = [")
for row in T:
    print(f" {row},")
print("]")

print("\nEdrop = [")
for row in Edrop:
    print(f" {row},")
print("]")

print("\nEbox = [")
for row in Ebox:
    print(f" {row},")
print("]")