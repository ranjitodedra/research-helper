import math
import numpy as np

# Constants
M1 = 1530  # Mass with load (kg)
M2 = 5     # Mass without load (kg)
m = 100    # Additional mass (kg)
f = 0.01   # Friction coefficient
base_speed = 50  # Base speed (km/h)
A = 2.5    # Frontal area (m²)
g = 9.8    # Gravity (m/s²)
alpha_deg = 0.86  # Road angle (degrees)
p = 1.205  # Air density (kg/m³)
c = 0.3    # Drag coefficient (assumed value)

# Input matrices
D = [
 [0.0, 4.97, 5.47, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [4.97, 0.0, 5.41, 3.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [5.47, 5.41, 0.0, 4.46, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.76, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.47],
 [0.0, 3.8, 4.46, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.7, 5.62, 5.13, 6.36, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.34, 0.0, 0.0, 0.0, 6.72, 7.62, 6.94, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.09, 0.0, 0.0, 0.0, 0.0, 7.83, 5.49, 0.0, 4.95, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.09, 0.0, 5.3, 0.0, 0.0, 0.0, 6.6, 0.0, 0.0, 0.0, 6.02, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.72, 4.74, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 5.34, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 4.7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.74, 3.55, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 7.33, 0.0, 0.0, 5.62, 0.0, 0.0, 0.0, 0.0, 0.0, 3.74, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 5.13, 0.0, 7.83, 6.6, 0.0, 0.0, 3.55, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 4.05, 6.36, 6.72, 5.49, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.11, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 7.76, 0.0, 0.0, 7.62, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.11, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 6.94, 4.95, 0.0, 6.72, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.71, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.02, 4.74, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.92, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.85, 0.0, 3.05, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.85, 0.0, 6.54, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.71, 0.0, 0.0, 6.54, 0.0, 7.56, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.92, 3.05, 0.0, 7.56, 0.0, 0],
 [0.0, 0.0, 5.47, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
]

TF = [
 [0.0, 0.91, 0.72, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.91, 0.0, 0.99, 0.67, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.78, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.72, 0.99, 0.0, 0.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.79, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.72],
 [0.0, 0.67, 0.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.86, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.82, 0.75, 0.88, 0.98, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.97, 0.0, 0.0, 0.0, 0.96, 0.92, 0.91, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.84, 0.0, 0.0, 0.0, 0.0, 0.83, 0.82, 0.0, 0.98, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.84, 0.0, 0.9, 0.0, 0.0, 0.0, 0.96, 0.0, 0.0, 0.0, 0.88, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.96, 0.87, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.97, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.82, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.68, 0.96, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.78, 0.0, 0.0, 0.75, 0.0, 0.0, 0.0, 0.0, 0.0, 0.68, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.88, 0.0, 0.83, 0.96, 0.0, 0.0, 0.96, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.86, 0.98, 0.96, 0.82, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.79, 0.0, 0.0, 0.92, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.91, 0.98, 0.0, 0.96, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.64, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.88, 0.87, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.65, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 0.0, 0.69, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 0.0, 0.75, 0.0, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.64, 0.0, 0.0, 0.75, 0.0, 0.65, 0],
 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.65, 0.69, 0.0, 0.65, 0.0, 0],
 [0.0, 0.0, 0.72, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
]

# Pre-calculate trigonometric values
cos_alpha = math.cos(math.radians(alpha_deg))
sin_alpha = math.sin(math.radians(alpha_deg))

# Initialize output matrices
n = len(D)
T = [[0.0 for _ in range(n)] for _ in range(n)]
Edrop = [[0.0 for _ in range(n)] for _ in range(n)]
Ebox = [[0.0 for _ in range(n)] for _ in range(n)]

# Calculate matrices
for i in range(n):
    for j in range(n):
        if D[i][j] != 0.0:  # Only calculate for existing edges
            d = D[i][j]  # Distance in km
            traffic_factor = TF[i][j]
            v0 = base_speed * traffic_factor  # Actual speed (km/h)
            
            # Travel time (minutes) - convert from hours to minutes
            T[i][j] = round((d / v0) * 60, 2)
            
            # Determine dv_dt based on speed
            if 50 <= v0 <= 80:
                dv_dt = 0.3
            elif 81 <= v0 <= 120:
                dv_dt = 2
            else:
                dv_dt = 0
            
            # Calculate Edrop (energy with load)
            Edrop[i][j] = round((1 / 3600) * (
                M1 * g * (f * cos_alpha + sin_alpha) + 
                0.0386 * (p * c * A * v0**2) + 
                (M1 + m) * dv_dt
            ) * d, 2)
            
            # Calculate Ebox (energy without load)
            Ebox[i][j] = round((1 / 3600) * (
                M2 * g * (f * cos_alpha + sin_alpha) + 
                0.0386 * (p * c * A * v0**2) + 
                (M2 + m) * dv_dt
            ) * d, 2)

# Print results
def print_matrix(matrix, name):
    print(f"\n{name} = [")
    for row in matrix:
        formatted_row = [f"{val:.2f}" if val != 0 else "0.0" for val in row]
        print(f" [{', '.join(formatted_row)}],")
    print("]")

print("=" * 80)
print("RESULTS")
print("=" * 80)

print_matrix(T, "T (Travel Time in minutes)")
print_matrix(Edrop, "Edrop (Energy with load)")
print_matrix(Ebox, "Ebox (Energy without load)")

# Also print in Python list format for easy copying
print("\n" + "=" * 80)
print("COPY-PASTE FORMAT")
print("=" * 80)

print("\nT = [")
for row in T:
    print(f" {row},")
print("]")

print("\nEdrop = [")
for row in Edrop:
    print(f" {row},")
print("]")

print("\nEbox = [")
for row in Ebox:
    print(f" {row},")
print("]")